import gc
import math
from numpy import *
import numpy.random
from sklearn.datasets import fetch_mldata
import sklearn.preprocessing
import numpy as np
import matplotlib as mpl
#mpl.use('Agg')
import matplotlib.pyplot as plt
from matplotlib import style
style.use("ggplot")
from sklearn import svm
from sklearn import svm
from sklearn.model_selection import GridSearchCV, cross_val_score
from sklearn.model_selection import PredefinedSplit
from sklearn.metrics import accuracy_score
import scipy
from statsmodels.sandbox.stats.multicomp import fdrcorrection0
import time
from matplotlib.ticker import FormatStrFormatter
import math

steps = 200
intervals = 3

# normal
logistic_regression = [0.794163285805355, 0.88289776647247142, 0.85611644330875836, 0.89193876081718904, 0.91508204563393336, 0.90714532588507291, 0.91241258966980221, 0.93747326484209292, 0.95179510978098603, 0.94807799724621944, 0.96189326047860069, 0.96276977326748825, 0.96012496630192667, 0.96224345852143522, 0.96119485978327202, 0.96106794852074562, 0.96123605421899661, 0.96141058101702392, 0.96018464317791796, 0.9615460945005273, 0.960323876836779, 0.95833383935872019, 0.95749409134284347, 0.96080550414845867, 0.95761081531190917, 0.95726158129489813, 0.96318827298506626, 0.96426221010354873, 0.96236497037120583, 0.96467446492609044, 0.96411595045792642, 0.96340155524039373, 0.96568091493541686, 0.96441003661561209, 0.96800687971641786, 0.96779965543993818, 0.96752765009486175, 0.96589988156426154, 0.96635189925189879, 0.96494117474911045, 0.96453034015798522, 0.96274710233266969, 0.96259691624517707, 0.96329827778850152, 0.9655326517347731, 0.96415224082567941, 0.96468699272618719, 0.96517166852004732, 0.96355573316721765, 0.96395533714698023, 0.96618025256973061, 0.96661153197543315, 0.96633802537655078, 0.96605008291003913, 0.96579633677745114, 0.96634848471556045, 0.96597118017753714, 0.96591960760097351, 0.96517104487271399, 0.96308855038733743, 0.96299608924291191, 0.96310613878415607, 0.96332137538010776, 0.96399794158550645, 0.96407822590169323, 0.96321777364621985, 0.9636059466954523, 0.96353511211508158, 0.96311547899799466, 0.96450543483122431, 0.964579413699585, 0.96492557676884338, 0.96510177574980516, 0.96571395036849739, 0.96678878060245732, 0.96660961379859456, 0.966434547117761, 0.96875713338740665, 0.96877908842985183, 0.9696841285324268, 0.9700393570652498, 0.96998690495450968, 0.97015481576443852, 0.96975553738550724, 0.96836405424499061, 0.96774170708345353, 0.96788288766616581, 0.96781673621119213, 0.96782531705390618, 0.96778579230270834, 0.96731118632358304, 0.96877272347518117, 0.96840026909770727, 0.96846362891782856, 0.96888746518811275, 0.96854392483668728, 0.96840111421817132, 0.96844884886986216, 0.96853622871497669, 0.96938690864386357, 0.96860511014286277, 0.96861816979807303, 0.96869913314911948, 0.96895664547714022, 0.96883459364951485, 0.96856477040912758, 0.96911721981040577, 0.96934963969354049, 0.96935739889429084, 0.96933362091813069, 0.96936251646768257, 0.96924682382688798, 0.96844928403362618, 0.96867145575743763, 0.96860736116798518, 0.9686423716444027, 0.96867589439488311, 0.9686063503316884, 0.96880657040840334, 0.96896616503965238, 0.96872778040055552, 0.96878602106551814, 0.96894102791890457, 0.9689507701927671, 0.96904221739948126, 0.96915320026263951, 0.96912371824743404, 0.96943559101921495, 0.97273996983591393, 0.97329666689597139, 0.97463625239543039, 0.97427583040157706, 0.973770588874595, 0.97362897638394297, 0.97396749689793727, 0.97445440313203213, 0.97440716988860887, 0.97441402813468392, 0.97390914146041074, 0.97418327466799448, 0.97419363630455391, 0.97357017476638608, 0.97364453348682711, 0.97363738595016014, 0.97327712679359912, 0.97302926682255786, 0.97142545904420652, 0.96937123265499336, 0.96948696760599984, 0.96939039046516062, 0.96932303763881988, 0.96980289815127763, 0.96973308530731084, 0.97130940451823911, 0.97119002769261553, 0.97136113935822144, 0.97119858560825933, 0.97116350979398924, 0.97017710187999628, 0.96993934726171782, 0.96996104488630674, 0.96947342116586233, 0.9695195983139071, 0.969585231683874, 0.9699052519124034, 0.9697964833490802, 0.97009660369541062, 0.9701729988607285, 0.97016279674377282, 0.97025909236759278, 0.96939314490884632, 0.9689291050357689, 0.96919937990110561, 0.96930297926681708, 0.96906531170269727, 0.96923828635936271, 0.96926552634798191, 0.96929642353529832, 0.96807527307938057, 0.96790100377822574, 0.96756038895071916, 0.96779392677891685, 0.96860996283579015, 0.96868122490705222, 0.96863094681897643, 0.96826746102298666, 0.96830976850214401, 0.96794795491293717, 0.9679349230147638, 0.96763198128834538, 0.96787536840168065, 0.96749487483982188, 0.96749873011461707, 0.9678958748839529, 0.96749889894179897, 0.96771957384915441, 0.967077938220266, 0.96674715736980144, 0.96666295477245645, 0.96704449242952673]
distance = [0.8073924774074106, 0.86705284598442689, 0.86415311980935849, 0.88327069481180764, 0.91266463537030584, 0.91715706500060379, 0.91410247178771686, 0.92982063045066676, 0.94057139371960063, 0.92169123128270858, 0.92757522756143085, 0.92586561532478873, 0.92499398917407805, 0.92894737307317143, 0.92709420369976248, 0.9312386081899543, 0.9301704023526336, 0.9417942210349125, 0.94116835318025482, 0.94182604095506639, 0.94130989009280408, 0.93996544508127866, 0.94040122992846198, 0.949181476800112, 0.9485270194280716, 0.94803782410255422, 0.95237842004153672, 0.95272273961777376, 0.94873261265256814, 0.95083281943973463, 0.95068367129376163, 0.95105423228691488, 0.95380467873626318, 0.95254533106431671, 0.95724307507611373, 0.95555984558431428, 0.95533221825317916, 0.95410622442055448, 0.95533234158971747, 0.95519195279758962, 0.95539326908234123, 0.95448460584489037, 0.95635107297173005, 0.95612984434293868, 0.95776297267397958, 0.95730329246617774, 0.95968651574652863, 0.95909859471606962, 0.95865999499934806, 0.95912962010808511, 0.95989087300274956, 0.9599575988267024, 0.96063835447423362, 0.95957330287626874, 0.95907101738203815, 0.95807405820755487, 0.95922511252187981, 0.95919517510713503, 0.95812417664333493, 0.95568786675407547, 0.95558249470886503, 0.95475139193274328, 0.95576962773576246, 0.95819575542754176, 0.95851011477382053, 0.95820444324238285, 0.9583650698472489, 0.95850696581463701, 0.95730169912964858, 0.95649503347992437, 0.95791187276934031, 0.95779592952904946, 0.95805529354427166, 0.95878956430856499, 0.95876043300958447, 0.95815457057519671, 0.95849640739598052, 0.96001596621867813, 0.96079060273105887, 0.96145449826710006, 0.9614959604750396, 0.96139909104747701, 0.96175763276019244, 0.96106353699544123, 0.95987152090367966, 0.95885251106554004, 0.96175113199251461, 0.96208988562834252, 0.96168882190007865, 0.96162439130391886, 0.96182571899168734, 0.96248312949780268, 0.96216176821355681, 0.96189220492304073, 0.96218851612209555, 0.96019575353844488, 0.96033947929062058, 0.96051614791412054, 0.96049405973490798, 0.96038561416983104, 0.95985884221644557, 0.95821968212920328, 0.95848715142669794, 0.95860085695587127, 0.95865021326300659, 0.95845730404289731, 0.95904536359668779, 0.95904974719637581, 0.9594224438569231, 0.95939573689217195, 0.95956585330784527, 0.95916603323985483, 0.95940059602212213, 0.95930121068789997, 0.95917125027238281, 0.95936701666425228, 0.95956535988910596, 0.95961352068787242, 0.95952955325582923, 0.95956550126775009, 0.95995170669236585, 0.95999979197529905, 0.96063758658143517, 0.96050936260894759, 0.96054818385799268, 0.96071804578531006, 0.96084104147341931, 0.96152610869865973, 0.96526725047621631, 0.96620221213818025, 0.96636190708280678, 0.96606758982658347, 0.96670226304336393, 0.9659522518637893, 0.96691871600584078, 0.96713136706839808, 0.96693396582802404, 0.96686238645049127, 0.96667251377120711, 0.96659439880310727, 0.96709574582677293, 0.96659565354386046, 0.96651140318730311, 0.96673488483373915, 0.96647011268170357, 0.96637185432270434, 0.96610262173520045, 0.96558822248300902, 0.96572905227993378, 0.96558761463535014, 0.9656454150516256, 0.96571375423978745, 0.96558279376931877, 0.96700208119284525, 0.9672484441693141, 0.96687227508184248, 0.96742880312771118, 0.96768067986312301, 0.96768465860736463, 0.9671247807704948, 0.96695995465896767, 0.96671714884998994, 0.96638439094486972, 0.9665543109581034, 0.96635811735251664, 0.96674504414658424, 0.96680786958332376, 0.96681022897727187, 0.96688962295375303, 0.96684063016309385, 0.96672807135374117, 0.96671236942593808, 0.96670051726454598, 0.96688894130263492, 0.96675558397730099, 0.96685078550215064, 0.96713644043987446, 0.96707765887181873, 0.96685826229575833, 0.96677095332483964, 0.96627522091762263, 0.96645883697429125, 0.9663996128945247, 0.9665656265310314, 0.96666152318984122, 0.96612310693477466, 0.96618902288299791, 0.96563833003096955, 0.96576016843614387, 0.96530915565438724, 0.96534532873219026, 0.96520942063777304, 0.96454100426974509, 0.9647101680945358, 0.96530336629118785, 0.96523999977958908, 0.96484772410086883, 0.96499055643942655, 0.96475033877895178, 0.96469096926619557]

# reversed
# logistic_regression = [0.76632284639258186, 0.75493524826544323, 0.76485534880709161, 0.72595223164689682, 0.74159369074993153, 0.87249367691883661, 0.87587921734070873, 0.88362566473345283, 0.89088963858567582, 0.89518299251873867, 0.90063275213856975, 0.90124365693610087, 0.90380744754973341, 0.90490060007204176, 0.9043843443798032, 0.9085470207188322, 0.91232633599053747, 0.90081181525600462, 0.89859028159689058, 0.89918265904451311, 0.89746583784586487, 0.90382306023425441, 0.91381568876644492, 0.92158940092025343, 0.92304628804501243, 0.92341142958998057, 0.92325932373897712, 0.927459868578417, 0.92781279267071515, 0.92844016292299225, 0.92844837458856921, 0.9237742151474817, 0.9230858466602665, 0.92140506728295724, 0.9257344515283672, 0.92715666107844685, 0.92473095084802037, 0.92352985045696168, 0.92453512453959696, 0.92424729221020852, 0.92377283835415458, 0.92768076448836501, 0.92463729801517136, 0.9308412848164902, 0.93151504894770798, 0.93238582578962459, 0.9388435905262581, 0.93973333634770539, 0.93868052655543255, 0.945772562179785, 0.94228958718211975, 0.94237318641276069, 0.94257809282432403, 0.94423523592461012, 0.94684753240359676, 0.94597136549573368, 0.94953870367198667, 0.95034615043953719, 0.95013282785483832, 0.95045205063385918, 0.94817646625216923, 0.94820359152451827, 0.94952371372535693, 0.94991843819065436, 0.95031890723240653, 0.94990055783619398, 0.9504803906592445, 0.94730484106068802, 0.95274844750046728, 0.95234013837777665, 0.95301961921465916, 0.952887395898666, 0.95125438249815342, 0.95173683081703886, 0.95512433265462582, 0.95553463439395736, 0.95680408197522371, 0.95651788885827183, 0.95603964955434684, 0.95600656008301621, 0.95464057945658642, 0.95422621778846373, 0.95361937467223667, 0.95301009737263642, 0.95425165530536682, 0.95320595579139378, 0.95451630338749427, 0.953960165866379, 0.95337460229834503, 0.95353384017718579, 0.95323011830905657, 0.95283214063817812, 0.95292845515590974, 0.95334878413088509, 0.95415098681274091, 0.95379991101214068, 0.95395181218295733, 0.95433754022641326, 0.9549058711496764, 0.95507057295102471, 0.95592461878648594, 0.95625486265146475, 0.95623237440108855, 0.95680814738732889, 0.95687933627887334, 0.95758038697762693, 0.95757383800388052, 0.95735062799529358, 0.95659762054637709, 0.95685528305193013, 0.95681808932460777, 0.95956707234669736, 0.95976143800461422, 0.95969087813949039, 0.9595301945769823, 0.96262309930032064, 0.96188876680306323, 0.96412734234134567, 0.9646206794675638, 0.96631953375005286, 0.96650020236222178, 0.96686919189979414, 0.96639040285036049, 0.96636872237037541, 0.96624021018061457, 0.96449064330256373, 0.96442708833819368, 0.96427575376622099, 0.96405134445337681, 0.96396952943732417, 0.96438393189630589, 0.96474676737130893, 0.96383961805061436, 0.96373560539960912, 0.96380122267428558, 0.96415656632549729, 0.96486187879883123, 0.96475806002775266, 0.96464419607690988, 0.96594572272547585, 0.96518228471987988, 0.96605726460871311, 0.96609589247441963, 0.96576010051881123, 0.96553105502811365, 0.96566143321800446, 0.96517535449528302, 0.96551223203321934, 0.96508658015791671, 0.96498704076727382, 0.96561434894781084, 0.96582940629582625, 0.96590460709446524, 0.96548551086432322, 0.96509206034797079, 0.96520552086332589, 0.96512145573645114, 0.96514711512381468, 0.96546994053258572, 0.96530995463331837, 0.96525322680975734, 0.96465222226520786, 0.96514987279908726, 0.96484257412464269, 0.96481397935538771, 0.96520622981643134, 0.96481280584947515, 0.964707263882983, 0.96459297630777763, 0.96465066596786819, 0.96524934664000206, 0.9649737421006428, 0.96450132404694888, 0.9641798718377721, 0.96364255700454071, 0.96335911973029997, 0.96413682148146795, 0.96646721318498174, 0.96672352534865025, 0.96671596540159199, 0.96737731802385163, 0.96715038230445205, 0.96759049929227037, 0.96743780436545879, 0.96723558895166517, 0.96738679872082256, 0.96625699162874634, 0.96704052685333619, 0.96674082171083808, 0.96662052610651794, 0.96800088545872354, 0.96868049999404637, 0.96823406971392267, 0.96838683623721844, 0.96747534948137859, 0.96789912334796369, 0.96804931113589876, 0.96804110872735216, 0.96795249555564244, 0.96775377671429619]
# distance = [0.7826296016430746, 0.76117933226990508, 0.78251932613240416, 0.75075595148886232, 0.74059877407509711, 0.85512792760776823, 0.83219516583240138, 0.84758062200720619, 0.86942106507532946, 0.87867503313507955, 0.89005363603203558, 0.88580434747774672, 0.8958340835674381, 0.89509724062402896, 0.89989156688861072, 0.89772913764371831, 0.90396376258799349, 0.90292770443653758, 0.90310314953819137, 0.90017932812942725, 0.90299758181059553, 0.90172600284166882, 0.9067283071870047, 0.90798882834231998, 0.90961343902714797, 0.91168401783840702, 0.91110831274660264, 0.90980495917347337, 0.91099854582107442, 0.90944430177029312, 0.90848099702908913, 0.90391586019403047, 0.90425099471696968, 0.903915066571918, 0.90371453484453745, 0.90511061300814755, 0.90490788764940222, 0.90564080193018981, 0.90766291070694149, 0.91006766463974187, 0.91497965860836117, 0.92062280284133724, 0.91745751726127911, 0.92515857610827301, 0.92617105277924383, 0.92586454113211192, 0.93249981962403994, 0.93339887385665621, 0.93510618260330458, 0.93943044840174628, 0.93821562499417388, 0.93788695625189678, 0.93717805340557769, 0.93691748164833688, 0.93936717389014979, 0.93804404195751767, 0.94127663480226786, 0.94108322659003085, 0.94061616710372176, 0.94027152000266234, 0.93967949690371666, 0.94012854731492634, 0.94027503660827116, 0.94013948745326592, 0.94015089715744948, 0.94053308239556288, 0.94078779554109959, 0.93840705815826764, 0.94464474745163418, 0.94599116299630892, 0.94716505429908493, 0.94730011330935771, 0.94452246096716552, 0.94379158953072806, 0.95120378862300536, 0.95077103662973173, 0.94944891289221511, 0.94955332016635219, 0.94927193394500176, 0.94917344058360142, 0.94849400733084865, 0.94800595292181011, 0.94759832373875097, 0.9488175692777181, 0.94931183378230277, 0.94941723479692741, 0.95049206527266783, 0.95039141453803566, 0.95097943388841732, 0.9509647793889201, 0.95057448813397016, 0.9511195807451861, 0.95250218606650738, 0.95371457878434673, 0.95417420665509045, 0.95388490626080691, 0.9536339991421785, 0.95336607482846092, 0.95460988705687555, 0.95415004151250304, 0.95500579410503295, 0.95497133209575824, 0.95453309019951738, 0.95399247851543545, 0.95297068550891217, 0.9530711113918453, 0.95330145494335172, 0.9533163130452712, 0.95227230053259704, 0.95217122982171976, 0.95392832320433096, 0.95152360598333652, 0.95155595748108968, 0.95130518372060136, 0.95208892119197552, 0.95354466725502074, 0.95293191790177512, 0.95606627469410999, 0.95686686226645568, 0.96069069617614811, 0.96028654023803628, 0.96019408129047312, 0.96108472031638248, 0.9613481235465452, 0.9616695820287593, 0.96275906769743291, 0.9618886431476561, 0.96240311789963484, 0.96244762118877625, 0.96235549484785388, 0.96205803172848048, 0.96233609939379661, 0.96123003832757115, 0.96090602648890733, 0.9609258724954387, 0.96069737653673781, 0.96174742943878289, 0.96203604286217903, 0.9618357798687136, 0.96284894760116158, 0.96274088482845066, 0.96254002938073047, 0.96252094582994729, 0.96285438743221652, 0.96293624202860539, 0.96295124866312154, 0.96299272042777739, 0.96277481525189201, 0.9627792200334534, 0.96249689794200266, 0.96358833474104522, 0.96483623891907366, 0.96421635004777628, 0.96420460036094047, 0.96358039484115898, 0.96362043485141291, 0.96359372242850905, 0.96345188283859162, 0.96354595426269163, 0.96361803750264008, 0.96321331958384049, 0.96230236162308458, 0.96199812593327394, 0.96174600403875599, 0.96165929689643304, 0.96164107119668274, 0.96175202952642314, 0.96171751865109789, 0.96195277618893194, 0.96182562976923891, 0.96184066053744866, 0.96193407722144619, 0.96172378253913315, 0.96201730824252996, 0.96179863876675287, 0.96171393118639226, 0.96121352848440544, 0.9634963283057264, 0.96346057940702357, 0.96343756712191886, 0.96369289478368148, 0.96347063644090603, 0.96446862319841742, 0.96476793202244371, 0.96465858475549593, 0.96462783279474407, 0.96461273496461608, 0.96413900085825976, 0.96380481770789606, 0.96386280417564518, 0.96367688587128963, 0.96336984771308598, 0.9633448227837047, 0.96362257306091836, 0.96265010174911014, 0.96276482417447407, 0.96317331253995309, 0.96357332547224195, 0.96382651020317134, 0.96360205711973168]

# shuffled
# logistic_regression = [0.81242472850495062, 0.79587428176104402, 0.83539899606679113, 0.86594858956838527, 0.90492464747004031, 0.90135512631101788, 0.90653049875231884, 0.9070393887157332, 0.91298130712518455, 0.92225112233011564, 0.91758766267018699, 0.93926722890726011, 0.93622750449047987, 0.94213918630926652, 0.94149777954465053, 0.94132315202646188, 0.94927571131393729, 0.94839214343337797, 0.95094640384058449, 0.95120611214150075, 0.95166694902843152, 0.95298817236623423, 0.9514545271456829, 0.9528044369831784, 0.94928464721511929, 0.94894893639935718, 0.95064588143924422, 0.95084229077422822, 0.95047287687953053, 0.9536491400191387, 0.95376224379274466, 0.95335562653520323, 0.95357975983948007, 0.95293874080628016, 0.95066527211780016, 0.95133399197189694, 0.94834218005152415, 0.94771454882216344, 0.94763943811900142, 0.94609465059272557, 0.94756562334393823, 0.94832124663779604, 0.94777990168643778, 0.9491644469730367, 0.949247974778336, 0.94957678551541469, 0.94926308393433345, 0.94931107114646029, 0.95022673183597528, 0.95043914524257267, 0.95088939321705868, 0.95183562784641818, 0.95186956847128368, 0.9530514307740926, 0.95262215203061407, 0.95258241729956161, 0.95320480866474833, 0.95220690110362616, 0.95239641412833487, 0.95182362805219722, 0.95142900721772106, 0.95107907810840264, 0.95084422256018575, 0.9505806923470278, 0.95172674408145463, 0.95001542191077526, 0.95032237808321263, 0.95055318868254202, 0.95152489037694621, 0.9529422301271111, 0.95314820048946269, 0.95322362870041988, 0.95250891333408172, 0.95525040125529392, 0.9596534570181221, 0.9593563774998074, 0.95867622948669828, 0.95923051460445807, 0.9601245024273366, 0.95998350364106666, 0.96037050159943382, 0.96045379690403743, 0.96033941215211605, 0.96072483673780573, 0.96086183352454813, 0.96078795998523747, 0.96073391182076284, 0.96107154045143495, 0.9607368036174343, 0.96130249129547907, 0.96110983439148912, 0.95960285490569019, 0.96234457286322783, 0.9624143695193712, 0.96162792469033731, 0.96099031191881124, 0.96081057555770166, 0.9607143400920064, 0.96003511280139053, 0.9603035589716683, 0.96060296743941653, 0.96084111432190034, 0.95913749639430446, 0.95736247106284367, 0.95755061866048341, 0.95777785808274662, 0.95819320597776103, 0.95819348754119071, 0.95780448100557458, 0.95687935987673778, 0.96328722341352946, 0.96304804840494496, 0.96319061249663684, 0.96360623716955307, 0.9638589123954352, 0.96340093313262987, 0.96321342916861696, 0.96298849993705904, 0.96303140913809548, 0.96305337237540678, 0.96366177781145512, 0.96525815011865246, 0.96471254769796921, 0.96480196795161643, 0.96468534305461728, 0.9647629768459115, 0.96466633582273198, 0.9644785893597545, 0.9644638212825456, 0.96359641350137992, 0.96334301014816826, 0.96306023231087179, 0.96304155612562103, 0.96270746651217043, 0.96299472269167519, 0.96298463762007458, 0.96507397780928483, 0.96572400798772406, 0.96579247568500581, 0.96551138067802622, 0.96563770850579755, 0.96563130878738834, 0.96588502165929813, 0.96579532092182441, 0.96567690319359156, 0.96628842574938523, 0.9662980334301976, 0.96813705726016663, 0.96791140842617884, 0.96817228489244866, 0.96824799497706127, 0.96865992088184394, 0.96868742130255681, 0.96916814026663634, 0.96918092832884994, 0.96865527945182728, 0.96840915137062589, 0.96831378752785791, 0.9678613057787151, 0.96782120882103195, 0.9679099989631379, 0.96750774896235592, 0.96740872195173622, 0.96720169982304882, 0.96722375025566598, 0.96690687748651172, 0.96653499973518464, 0.96652692618970382, 0.96649742305062636, 0.96620403306126978, 0.96635929459675352, 0.96621419727396574, 0.96579418687328877, 0.96575725081680086, 0.96546394837409366, 0.96572923406722155, 0.96532803175597004, 0.96585313423607355, 0.96589861176615077, 0.96590052561713902, 0.96618142568983134, 0.96608014459778391, 0.96657448955275704, 0.96671318202931311, 0.96674169970068924, 0.96675958341644841, 0.96648228414593507, 0.9664498055172478, 0.96714726164506482, 0.96693969355398468, 0.9676269542622109, 0.96749308427679792, 0.96743695185690037, 0.96739086943016317, 0.96712151180151762, 0.96742091617553894, 0.96727796851194725, 0.96730178318235038, 0.96715047628464779, 0.96698595166042245]
# distance = [0.81542264368634654, 0.85210268629994401, 0.82882505549311991, 0.88796639294059398, 0.90077124777686701, 0.89445765972708924, 0.9079854456375378, 0.90424797791366451, 0.91039351989338291, 0.91681179133529977, 0.92235785997781827, 0.92371522670341766, 0.92610423428423894, 0.92899028016288432, 0.93090848821371119, 0.92582273645154878, 0.92559996830437119, 0.92526382689120013, 0.92512083508978016, 0.92159092997132208, 0.92395225994891594, 0.92440970959056623, 0.92641273125656076, 0.93000416400742336, 0.93548455345617487, 0.93664189318082036, 0.93710853160407126, 0.93982968860141869, 0.94063163592699051, 0.94031473038591284, 0.9381292687702153, 0.94194847656385539, 0.9444983188541114, 0.94659508946300441, 0.94569675541094023, 0.94461959119645589, 0.94172353820059107, 0.94523527672551633, 0.946592324345781, 0.94672923704065925, 0.94748234175567103, 0.94884334923105107, 0.94768916915071555, 0.94770550929262076, 0.94990972135258667, 0.95136727072939242, 0.95068589879923837, 0.95097243855636415, 0.9508223817983581, 0.95115145370463094, 0.95104100658494217, 0.9503647420959821, 0.95067120413960426, 0.95410593522317666, 0.95512732797092248, 0.95476590659040728, 0.95365979030512327, 0.95610663545301056, 0.95541653832569584, 0.95586652729947696, 0.95595248081142647, 0.95645578515452756, 0.95644560812708868, 0.95793095104478865, 0.95896413753832288, 0.95935833041268237, 0.9594936939729195, 0.96013826169412975, 0.95941549629995104, 0.95817740615729985, 0.9574625080438427, 0.95720575021202647, 0.95751778067328908, 0.95569674638331004, 0.9563669008353386, 0.95792001290390549, 0.96002841534088801, 0.96007553008860036, 0.95992988145726998, 0.95973105289726957, 0.95994243635403209, 0.95959863981418925, 0.96016141618307527, 0.95989267885369267, 0.95994161377540621, 0.9593767711120893, 0.95885172080504621, 0.96085587605139244, 0.96170077921372632, 0.96298182674677835, 0.96304902785976587, 0.96340421842574508, 0.96222364913498803, 0.96232669837495544, 0.97466484583028168, 0.97357111470461066, 0.97413644190100201, 0.97402281723323547, 0.9750223098355757, 0.97522458254725775, 0.97087242866605439, 0.97114222047232435, 0.97080141859320079, 0.97128944764478686, 0.9734154892703083, 0.97342766195381603, 0.97384760783856383, 0.97350453462859332, 0.97351659866836471, 0.97320278424495432, 0.9730494855584636, 0.97286532230237022, 0.97272492254618714, 0.97234586852475613, 0.9728217535426118, 0.97304831937170388, 0.97310288614367979, 0.97328404450361605, 0.97396143078727349, 0.97401077115788826, 0.97403657495961116, 0.97444382365164173, 0.97520616454007614, 0.97585358538993883, 0.9760783799058188, 0.9759082694447534, 0.97536013435558233, 0.97481160163195923, 0.9747569135105838, 0.97458943215716709, 0.97476419306928008, 0.97461490361081959, 0.97474428302662253, 0.97442659516983776, 0.97454026509596281, 0.97458932147415012, 0.97337052906743826, 0.97337713008666094, 0.97220048970920492, 0.97286684434953996, 0.97286504773747018, 0.97280310581724527, 0.97301847107184791, 0.97397998019891985, 0.97456850698300779, 0.97453941298923219, 0.97533091663202431, 0.97545909967554267, 0.97548615571752451, 0.9755731350162552, 0.97563944582490159, 0.97534835266541342, 0.97756365518510557, 0.97753737884631242, 0.97694089279136764, 0.97689959686272354, 0.97720200402359514, 0.97716354467447741, 0.97686001984328585, 0.97717998579476062, 0.97716679855117028, 0.97705652414324395, 0.97700723032979064, 0.97610090452553211, 0.97503272801523155, 0.97513641376569749, 0.97527432790262003, 0.97516976870670324, 0.97673967184847577, 0.97672589349838523, 0.97667624479653414, 0.97672846573835392, 0.97659703415167987, 0.97656847412414627, 0.97648242589719081, 0.97662708976095269, 0.97702956989662615, 0.97717943029574494, 0.97681137363142323, 0.97681435420983898, 0.97692333719165858, 0.97678987875083967, 0.97686643216951641, 0.97683303720242054, 0.97700175830496505, 0.97702465271079875, 0.97623131477810399, 0.97661996957974961, 0.97643005275138495, 0.97723203049336749, 0.97699510596793504, 0.97673997697160186, 0.97711038892626689, 0.97713989932197443, 0.97716237123208693, 0.97704535816107096, 0.97709280410740917, 0.97782256811019186, 0.97781259814523636, 0.977925336652685]

plt.plot([i*intervals for i in range(1,steps+1)], logistic_regression, label="logistic regression ranking")
plt.plot([i*intervals for i in range(1,steps+1)], distance, label="distance ranking")
plt.legend()
plt.savefig("c:\\users\hagai\\desktop\\figure_fre")

